<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Unfollower Checker v3</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="static/style.css">
<style>
  :root {
    --ig-pink: #E1306C;
    --ig-purple: #833AB4;
    --ig-blue: #405DE6;
}

body {
    background: #fafafa;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

.ig-header {
    background: linear-gradient(45deg, var(--ig-blue), var(--ig-purple), var(--ig-pink));
    color: white;
    padding: 4rem 0;
    text-align: center;
    margin-bottom: 3rem;
}

.upload-card {
    background: white;
    border-radius: 1rem;
    padding: 2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.file-upload {
    margin: 1.5rem 0;
    border: 2px dashed #ddd;
    padding: 2rem;
    border-radius: 0.5rem;
    transition: all 0.3s ease;
}

.file-upload:hover {
    border-color: var(--ig-pink);
    background: rgba(225, 48, 108, 0.05);
}

.btn-analyze {
    background: var(--ig-pink);
    color: white;
    padding: 1rem 2rem;
    border: none;
    border-radius: 0.5rem;
    width: 100%;
    font-size: 1.1rem;
    transition: transform 0.2s ease;
}

.btn-analyze:hover {
    transform: translateY(-2px);
    background: #C9225B;
}

.user-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border-bottom: 1px solid #eee;
}

.username {
    color: var(--ig-pink);
    text-decoration: none;
    font-weight: 500;
}

.username:hover {
    color: var(--ig-purple);
}

.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255,255,255,0.9);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

/* Complete CSS available in GitHub repo */
</style>
  </head>
<body>
    <div class="loading-overlay" id="loading">
        <div class="loader-content">
            <div class="spinner"></div>
            <p>Analyzing your Instagram connections...</p>
        </div>
    </div>

    <header class="ig-header">
        <div class="container">
            <h1>
                <i class="fab fa-instagram"></i>
                Instagram Unfollower Checker
                <span class="badge bg-light text-dark">v3.0.0</span>
            </h1>
            <p class="lead">Discover who isn't following you back</p>
        </div>
    </header>

    <main class="container main-content">
        <div class="upload-card">
            <h2><i class="fas fa-cloud-upload-alt"></i> Upload Your Data</h2>
            <form id="uploadForm" enctype="multipart/form-data">
                <div class="file-upload">
                    <label for="following">
                        <i class="fas fa-user-plus"></i>
                        Following Data (JSON/HTML)
                    </label>
                    <input type="file" id="following" name="following" required>
                </div>
                
                <div class="file-upload">
                    <label for="followers">
                        <i class="fas fa-users"></i>
                        Followers Data (JSON/HTML)
                    </label>
                    <input type="file" id="followers" name="followers" required>
                </div>

                <button type="submit" class="btn-analyze">
                    <i class="fas fa-search"></i>
                    Analyze Connections
                </button>
            </form>
        </div>

        <div id="results" class="results-container"></div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>Developed by Prabin Bhandari â€¢ 
                <a href="https://github.com/prabinbessie/instagram-unfollower-checker" target="_blank">
                    <i class="fab fa-github"></i> View on GitHub
                </a>
            </p>
            <div class="disclaimer">
              <B>We doesnt store your data in anyway</B>
              <br>
                <small>Not affiliated with Instagram. </small>
            </div>
        </div>
    </footer>

    <script>
    document.getElementById('uploadForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        const loading = document.getElementById('loading');
        
        try {
            loading.style.display = 'flex';
            
            // Process~analysis
            const analysis = await fetch('/analyze/json', {
                method: 'POST',
                body: formData
            });
            
            if (!analysis.ok) throw await analysis.json();
            const {count, results} = await analysis.json();

            // Display results n link 
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = results.length ? `
                <div class="results-card">
                    <h3><i class="fas fa-users-slash"></i> ${count} Non-Followers Found</h3>
                    <div class="user-list">
                        ${results.map(user => `
                            <div class="user-item">
                                <a href="${user.profile_url}" target="_blank" class="username">
                                    @${user.username}
                                </a>
                                <span class="badge">#${user.id}</span>
                            </div>
                        `).join('')}
                    </div>
                    <button class="btn-download-pdf" onclick="generatePDF()">
                        <i class="fas fa-file-pdf"></i> Download PDF Report
                    </button>
                </div>
            ` : `<div class="alert-success">All follows are mutual! ðŸŽ‰</div>`;

            // Autodownload the PDF
            const pdfResponse = await fetch('/analyze/pdf', {
                method: 'POST',
                body: formData
            });
            const pdfBlob = await pdfResponse.blob();
            const pdfUrl = URL.createObjectURL(pdfBlob);
            const link = document.createElement('a');
            link.href = pdfUrl;
            link.download = `instagram_non_followers_${Date.now()}.pdf`;
            link.click();

        } catch (error) {
            showError(error.message || 'An error occurred');
        } finally {
            loading.style.display = 'none';
        }
    });

    function showError(message) {
        const alert = document.createElement('div');
        alert.className = 'alert-error';
        alert.innerHTML = `
            <i class="fas fa-exclamation-triangle"></i>
            ${message}
        `;
        document.getElementById('results').prepend(alert);
        setTimeout(() => alert.remove(), 5000);
    }
    </script>
</body>
</html>